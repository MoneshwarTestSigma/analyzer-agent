from map_logs_to_step import map_logs_to_steps
from step_result_transformer import get_transformed_step_results
from utils import getFile, save_mapped_results


if __name__ == "__main__":

    mapped_results_file_path = "mapped_results.json"

    # Log URLS
    console_log_url =  "https://s3.amazonaws.com/quarterly-expirable-attachments-devtesting.testsigma.com/200001212/executions/logs/28/console.log?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIGfA%2FM9N%2F2kDRZhwaBpEiQUgOECB1NbgtiXj1gvPI3GQAiEAvDhQVl31Ysu6QOBjF9IRkEFIWD1HkxHL2THfT5X%2FPGcqoQII0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgw2ODk4MjU1NDQ0NTAiDNIk5AHJQxrkSVxhRCr1AbZM%2B4gPlZYY433UjFllEKggTeTe9phFHHDbHhlTWS%2Fd05s811X1XHPDSULIkyiDZ4PbusUINeUyxs%2FUtfX1X09rQgLfTi465nPz2aMJVdBdV1iNJoiVJ0uUeVqXwUUtgTp8Mcms%2BZhcRCIRYhLC1o0W8y%2FLxOFplEKa%2F5PaPfaFp457yPA5nvRhlQ1Wi%2BK75knNpTD8VY59pBxP7oMnHIf9BbI4uw6GCvRwbEyKtQmDd1BJzQILG7UYzXaxvSnrHV2mmcWkj8HALoHnPr4Ew4YNF1686AWfY4Aca%2BIRo%2F1uwVFK%2BLPCglYnWJizaMM3ODy8YS46MLjIyr4GOp0BUhm9E8GKnT50p5CIzWjuwFKNFU9KkuZ0ylc1ZVRVntyMg49dkX4xXQfXvGE6O7e6QMCkwByZaVDhofr74UNPDpLAah%2B7wWnXfXvkZWmapg2GvjNHObzr6%2FjkLaZ4lfKG6KzCX4RfC8njs2eRer92rSietUB11UsayiPUuaPZx8o5N6jiTKxILVvK4KT7yJLe7UFY1q6F9aqeJdFT7g%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20250313T094607Z&X-Amz-SignedHeaders=host&X-Amz-Credential=ASIA2BHGOPEBAMI2ZMPO%2F20250313%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Expires=10800&X-Amz-Signature=64822806ce3bfbc05bf544ad4063867897c87ed8020655cdfaddc5420a59ca4e"

    network_log_url =  "https://s3.amazonaws.com/quarterly-expirable-attachments-devtesting.testsigma.com/200001212/executions/logs/28/network.har?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIGfA%2FM9N%2F2kDRZhwaBpEiQUgOECB1NbgtiXj1gvPI3GQAiEAvDhQVl31Ysu6QOBjF9IRkEFIWD1HkxHL2THfT5X%2FPGcqoQII0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgw2ODk4MjU1NDQ0NTAiDNIk5AHJQxrkSVxhRCr1AbZM%2B4gPlZYY433UjFllEKggTeTe9phFHHDbHhlTWS%2Fd05s811X1XHPDSULIkyiDZ4PbusUINeUyxs%2FUtfX1X09rQgLfTi465nPz2aMJVdBdV1iNJoiVJ0uUeVqXwUUtgTp8Mcms%2BZhcRCIRYhLC1o0W8y%2FLxOFplEKa%2F5PaPfaFp457yPA5nvRhlQ1Wi%2BK75knNpTD8VY59pBxP7oMnHIf9BbI4uw6GCvRwbEyKtQmDd1BJzQILG7UYzXaxvSnrHV2mmcWkj8HALoHnPr4Ew4YNF1686AWfY4Aca%2BIRo%2F1uwVFK%2BLPCglYnWJizaMM3ODy8YS46MLjIyr4GOp0BUhm9E8GKnT50p5CIzWjuwFKNFU9KkuZ0ylc1ZVRVntyMg49dkX4xXQfXvGE6O7e6QMCkwByZaVDhofr74UNPDpLAah%2B7wWnXfXvkZWmapg2GvjNHObzr6%2FjkLaZ4lfKG6KzCX4RfC8njs2eRer92rSietUB11UsayiPUuaPZx8o5N6jiTKxILVvK4KT7yJLe7UFY1q6F9aqeJdFT7g%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20250313T094607Z&X-Amz-SignedHeaders=host&X-Amz-Credential=ASIA2BHGOPEBAMI2ZMPO%2F20250313%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Expires=10800&X-Amz-Signature=26087010d405bf3f518558bd3f773adfba19a4dc2c4fb039b8aae8238b50ae6c"

    selenium_log_url = "https://s3.amazonaws.com/quarterly-expirable-attachments-devtesting.testsigma.com/200001212/executions/logs/28/selenium.log?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIGfA%2FM9N%2F2kDRZhwaBpEiQUgOECB1NbgtiXj1gvPI3GQAiEAvDhQVl31Ysu6QOBjF9IRkEFIWD1HkxHL2THfT5X%2FPGcqoQII0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgw2ODk4MjU1NDQ0NTAiDNIk5AHJQxrkSVxhRCr1AbZM%2B4gPlZYY433UjFllEKggTeTe9phFHHDbHhlTWS%2Fd05s811X1XHPDSULIkyiDZ4PbusUINeUyxs%2FUtfX1X09rQgLfTi465nPz2aMJVdBdV1iNJoiVJ0uUeVqXwUUtgTp8Mcms%2BZhcRCIRYhLC1o0W8y%2FLxOFplEKa%2F5PaPfaFp457yPA5nvRhlQ1Wi%2BK75knNpTD8VY59pBxP7oMnHIf9BbI4uw6GCvRwbEyKtQmDd1BJzQILG7UYzXaxvSnrHV2mmcWkj8HALoHnPr4Ew4YNF1686AWfY4Aca%2BIRo%2F1uwVFK%2BLPCglYnWJizaMM3ODy8YS46MLjIyr4GOp0BUhm9E8GKnT50p5CIzWjuwFKNFU9KkuZ0ylc1ZVRVntyMg49dkX4xXQfXvGE6O7e6QMCkwByZaVDhofr74UNPDpLAah%2B7wWnXfXvkZWmapg2GvjNHObzr6%2FjkLaZ4lfKG6KzCX4RfC8njs2eRer92rSietUB11UsayiPUuaPZx8o5N6jiTKxILVvK4KT7yJLe7UFY1q6F9aqeJdFT7g%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20250313T094607Z&X-Amz-SignedHeaders=host&X-Amz-Credential=ASIA2BHGOPEBAMI2ZMPO%2F20250313%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Expires=10800&X-Amz-Signature=0a28655acb24b9102d491a96f89e00f6f57b202829c9909cd546069138f23231"
    execution_log_url = "https://s3.us-east-1.amazonaws.com/quarterly-expirable-attachments-devtesting.testsigma.com/200001212/execution-logs/run-24/test-case-result-65.log?response-content-disposition=inline&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCICTWaxVrZHi0MqVEIdN37pIrCrRJ54ebeLrbiIJtYQbBAiEA9h06mYjPbBW%2FIHGlkIxWV9NJCE8YpCqrs%2B72BudvrOYq%2BwMI0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgw2ODk4MjU1NDQ0NTAiDKQg4YwfSpvTfKvvBSrPAwuP4tRM81DE7ZcTfnWvvzwWaVcuiM0NwBjnjD7I27wv5RX9x8N%2BSj%2B6CaGUxyy%2FkKVLWkmq8gxAGTR3SS%2B62mk7dzAuEH1%2FAcjoHdx8DCB8sIfDUSkCJpfSt%2FC%2Fq%2B2WrpMZG6tchZW289fW5RK79Pl9s%2Bm7XAYz32Q%2BOEcf6vDgcgZ%2F7hWTVVHCDdKcNIWLKRm1zmbyoz1UFXjRoGxoZfNp73Rgm1lCm0zxAZ0ebSDv1Cop%2By5CRNDVTEAldFyO3qtb6t5es9QVO3Ct7Ej4SaNhkd%2Fs58pKvtPNx4OIvYaa0BxXpTcXJxrPad%2BlNj2Ejd3iQxrasvzxtgbK7ijuu00fOjYRkYXUfy%2B2NLIy4JfFjs%2FbhMJC%2BmLRQFZLJv4DzpyQtSvWRGakEtOLA40HnYZkLQbbskfGrJQcHBCNBBut517OEuaevW9IPAJsnDp6qBWQLzZXNWQd4Nv0QzzhxMIBGz%2BA%2Bjar8%2BrO4VubDZKycddxqVjf0Nh8A9oUzI90L0bQNd90CTSug2ZvXZ0IuM6FjgpoKZAXlO67q80b%2FgQG9zCvjW%2FxKyY1hRhVh6Lx8ZuNw3xcwevgB5ZhbzWT3dVbHXgBK5WS7%2FFrAxTzJTow%2FtPKvgY6vQKD1ZtMTriCL3XUC9hD%2B90UGRCQl6oNWP8SKQPMW%2FqMnla7vhWI4v0Dg%2B8o0UfmT%2BK2fgxRp07fN0%2BbGrdopwaNRG5VYmaKYDbUXXuiKJXrCh45Ty4lwTvi0nGEVAlT%2FRfYW%2BDtLQ5WLdQXTeXyJ2H%2FbRXU9jm9PQ9sa7%2BWkILY2udZRxtigiNrzt3w5Y0nO5kXf%2BXud7it%2FhmRdNKKitbniZzDAMLVtL0Hutj7P1A99ZFWv%2F9Mf3eWWqZcXbkD7Q8dmlUtLFQ85Q6JTxssUtq6v1wjBUCh2gBa3Tvh9re2m1Zrno3uFkyete54r%2BocXjNuEEdv3dBkRCYIQKrm7Os0OvguV%2FRfx1ohi5CgpVbjzGhA8uT8a%2Fbk%2BZrZL4PNpeowZDILYgLDPXgh2taUb5NZy%2FQFvDsJS2WiJCmCWg%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIA2BHGOPEBCWHU537U%2F20250313%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250313T095242Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=3951c97bce78d642dde97eb3ddfb2cc3e6a315b7a680842898138bd04e9025b7"
    # Steps URL

    stepUrls = [
"https://s3.amazonaws.com/results-devtesting.testsigma.com/200001212/step-results/run-24/test-case-result-65/step-results-0.json?response-content-encoding=gzip&response-content-type=application%2Fjson&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIFfVusQq5zjbsG1aYG29SvcUyT%2FMHwKf7JxvV%2F%2F%2B7HYbAiEAzyM75snPBX6CJAjU3W5P6pG2DcDQnI6sHGk6IVV%2FRCAqoQII0v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgw2ODk4MjU1NDQ0NTAiDOOmO6OZ1woGWz75hyr1AbKEGe2OvexWJpurb9S%2B5lBT3nYjcjg%2F22Bs%2FZiYQIT6dS%2FU3QWbuyI%2Be%2FBK2jCCI6ucFuilOZc%2FE9gT5T4eD04qHG585VnoN%2F54eTMJlFi0985SLXRXzhGFsP2SidDCEkpVxByQxq%2BC89vRTRyYBX2XMUu%2FbaJHmMRKiKGn72UnFn9RSdZkj%2Fp7zpOKLHitABF26H0yp1bLyiLnXZo%2B1eHyJwG13bcRknRrVG0BMOcuNcfhGiEJQrjmn2Z55e9bTkM0xIyrDYk%2FPq8anWkBYggEs5oMWpjEhCT6BHSrF36PH1RCNRMy6c2nPKguQTKMJ2ITo0rvMMDCyr4GOp0BQrEl7RYJaTCj2ltgEuzNgX5r4U0akCP%2BblbaiKyxkOkSAj4bCnF%2BYBadERA4uZTXATgcreXLfuq%2F8IuQzWYt1AFAYC38GPW3YGYHcXGSrGyxtaCU0N6Zi6A7rqo6dKQrRfqWjMEcQYMh1fm4aXNPuriu9ln7EslSNDyNyVRF8ij9OEN7oa2iKxXrmJgj1ROn4OMmpEUKMKJjvsA5Eg%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20250313T094531Z&X-Amz-SignedHeaders=host&X-Amz-Credential=ASIA2BHGOPEBLKFOV4RB%2F20250313%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Expires=3600&X-Amz-Signature=8a98b968fea69880011b22a79987177269d8407621c8e5772904400dbaca4422"
 ]


    steps_map = get_transformed_step_results(stepUrls)

    network_logs = getFile(network_log_url , 'utf-8')['log']['entries']
    execution_logs = getFile(execution_log_url , 'windows-1252')
    selinium_logs = getFile(selenium_log_url , 'windows-1252')
    console_logs = getFile(console_log_url, 'windows-1252')
    

    mapped_results = map_logs_to_steps(steps_map, network_logs, execution_logs, selinium_logs, console_logs)
    
    # # Save results
    save_mapped_results(mapped_results, mapped_results_file_path)

